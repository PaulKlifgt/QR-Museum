{% extends 'base.html' %}

{% block content %}
    <h2>–≠—Ç–æ –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</h2>
    <a href="/api/index/">–†–∞–∑–¥–µ–ª—ã</a>
    <hr>
    <span style="font-size: larger;">üîç</span> <input type="text" name="" id="inp">
    <br><br>
    <div class="need-upd">
        {% for game in games %}
            <details id="new-details-content">
                <summary class="rr"><span class="s">{{game.name}}</span><a href="/api/edit/gam/{{game.id}}" title="–ò–∑–º–µ–Ω–∏—Ç—å –∏–≥—Ä—É"> ‚úèÔ∏è </a></summary> 

                {% if games[game] %}
                    {% for que in games[game] %}
                        <li class="rr"><span class="s">{{que.name}}</span><a href="/api/edit/que/{{que.id}}" title="–ò–∑–º–µ–Ω–∏—Ç—å –≤–æ–ø—Ä–æ—Å"> ‚úèÔ∏è </a></li> 
                    {% endfor %}
                {% else %}
                    <l>–¢—É—Ç –ø—É—Å—Ç–æ</l>
                {% endif %}
            
            
                
            </details>
        {% endfor %}
    </div>
    <div id="question">
        <h2><a onclick="document.getElementById('question').style.display='none'">‚ùå</a></h2>
        <h3>–í—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å:</h3>
        <div>
            <a href="/api/create/gam/"><button class="btn btn-primary">–ò–≥—Ä–∞</button></a> 
            <a href="/api/create/que/"><button class="btn btn-primary" style="margin-right: 10px;">–í–æ–ø—Ä–æ—Å</button></a>
        </div>   
    </div>
    <br>
    <a onclick="document.getElementById('question').style.display='block'">‚ûï –ù–æ–≤–∞—è –∏–≥—Ä–∞/–≤–æ–ø—Ä–æ—Å</a>
    <script>
        var inp = document.getElementById("inp");
        var list_det = document.getElementsByClassName('need-upd')[0].getElementsByTagName('details');
        
        inp.oninput = function (){

            for (let i = 0; i < list_det.length; i++) {
                if (inp.value != '') {
                    console.log('open');
                    list_det[i].setAttribute('open', true);
                }
                else {
                    list_det[i].removeAttribute('open');
                }
                
                var list_rr = list_det[i].getElementsByClassName('rr')
                for (let j = 0; j < list_rr.length; j++) {

                    if (!list_rr[j].getElementsByClassName('s')[0].textContent.toLowerCase().includes(inp.value.toLowerCase())) {
                        $(list_rr[j]).hide();
                    }
                    else{
                        $(list_rr[j]).show();
                    }
                }
            }
        }
    </script>
{% endblock content %}